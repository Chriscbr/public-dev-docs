"use strict";(self.webpackChunkmomento_docs=self.webpackChunkmomento_docs||[]).push([[8105],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>d});var o=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,o,a=function(e,t){if(null==e)return{};var n,o,a={},r=Object.keys(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var s=o.createContext({}),c=function(e){var t=o.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},u=function(e){var t=c(e.components);return o.createElement(s.Provider,{value:t},e.children)},p="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},h=o.forwardRef((function(e,t){var n=e.components,a=e.mdxType,r=e.originalType,s=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),p=c(n),h=a,d=p["".concat(s,".").concat(h)]||p[h]||m[h]||r;return n?o.createElement(d,i(i({ref:t},u),{},{components:n})):o.createElement(d,i({ref:t},u))}));function d(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=n.length,i=new Array(r);i[0]=h;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[p]="string"==typeof e?e:a,i[1]=l;for(var c=2;c<r;c++)i[c]=n[c];return o.createElement.apply(null,i)}return o.createElement.apply(null,n)}h.displayName="MDXCreateElement"},7057:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>i,default:()=>m,frontMatter:()=>r,metadata:()=>l,toc:()=>c});var o=n(7462),a=(n(7294),n(3905));const r={sidebar_position:12,sidebar_label:"Drupal",title:"Use Momento As Your Drupal Cache",description:"Supercharge your Drupal cache by integrating with Momento",pagination_next:null},i="Integrating Momento Cache with Drupal",l={unversionedId:"cache/develop/integrations/drupal-integration",id:"cache/develop/integrations/drupal-integration",title:"Use Momento As Your Drupal Cache",description:"Supercharge your Drupal cache by integrating with Momento",source:"@site/docs/cache/develop/integrations/drupal-integration.md",sourceDirName:"cache/develop/integrations",slug:"/cache/develop/integrations/drupal-integration",permalink:"/cache/develop/integrations/drupal-integration",draft:!1,editUrl:"https://github.com/momentohq/public-dev-docs/tree/main/docs/cache/develop/integrations/drupal-integration.md",tags:[],version:"current",sidebarPosition:12,frontMatter:{sidebar_position:12,sidebar_label:"Drupal",title:"Use Momento As Your Drupal Cache",description:"Supercharge your Drupal cache by integrating with Momento",pagination_next:null},sidebar:"tutorialSidebar",previous:{title:"Amazon EventBridge",permalink:"/cache/develop/integrations/amazon-eventbridge"}},s={},c=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Drupal and Momento Rate Limiting",id:"drupal-and-momento-rate-limiting",level:3},{value:"Installing and Configuring the Momento Cache Drupal Module",id:"installing-and-configuring-the-momento-cache-drupal-module",level:2}],u={toc:c},p="wrapper";function m(e){let{components:t,...n}=e;return(0,a.kt)(p,(0,o.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"integrating-momento-cache-with-drupal"},"Integrating Momento Cache with Drupal"),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://www.drupal.org"},"Drupal")," is a free and open-source content management framework built in PHP and is considered to be among the most stable, secure, and flexible content management solutions available. By default, Drupal uses a database\u2014typically MySQL, MariaDB, or PostgreSQL\u2014to cache the results of relatively expensive calculations. However, there is a problem with this approach: databases are, relatively speaking, slow. As a site\u2019s need for scalability and performance increases, so do the advantages provided by a dedicated caching solution. "),(0,a.kt)("p",null,"Drupal offers integrations with popular cache backends such as Redis and Memcached, but the advantages of these solutions comes at a cost. To use either technology, you\u2019ll need to spend considerable time and effort provisioning and configuring server instances or clusters suitable to your workload. As your site\u2019s caching demands change over time, ensuring that the caching infrastructure is neither under- nor over-provisioned is critical to manage cost and performance. ",(0,a.kt)("strong",{parentName:"p"},"Momento Cache handles all of this for you"),", scaling automatically to handle fluctuations in demand."),(0,a.kt)("p",null,"In this guide we'll install and configure the Drupal integration module, ",(0,a.kt)("inlineCode",{parentName:"p"},"momento_cache"),", to serve as the cache backend for our Drupal CMS."),(0,a.kt)("p",null,"See the ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/momentohq/drupal-cache"},"Momento Drupal cache integration repository")," for more information."),(0,a.kt)("h2",{id:"prerequisites"},"Prerequisites"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"A Momento API token is required. You can generate one using ",(0,a.kt)("a",{parentName:"li",href:"https://console.gomomento.com"},"the Momento Console"),"."),(0,a.kt)("li",{parentName:"ul"},"A Momento cache to serve as your Drupal caching backend. You can create a cache to use in ",(0,a.kt)("a",{parentName:"li",href:"https://console.gomomento.com"},"the Momento Console"),". ",(0,a.kt)("strong",{parentName:"li"},"You must create the cache before using the module.")," If the cache doesn't exist, errors are written to the Drupal dblog as well as the logfile configured in your settings, if you have specified one."),(0,a.kt)("li",{parentName:"ul"},"PHP 7.4 or higher."),(0,a.kt)("li",{parentName:"ul"},"Drupal 9.4 or higher."),(0,a.kt)("li",{parentName:"ul"},"The ",(0,a.kt)("a",{parentName:"li",href:"https://github.com/grpc/grpc/blob/master/src/php/README.md"},"gRPC PHP extension"),"."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://getcomposer.org/doc/00-intro.md"},"Composer")," PHP dependency manager.")),(0,a.kt)("h3",{id:"drupal-and-momento-rate-limiting"},"Drupal and Momento Rate Limiting"),(0,a.kt)("p",null,"Momento's free tier limits accounts' transactions per second (TPS) and throughput (KiBps), and requests that exceed those limits are throttled. Drupal's usage of the cache backend is significantly higher than the default limits, so prior to using the integration please reach out to ",(0,a.kt)("a",{parentName:"p",href:"mailto:support@momentohq.com"},"support@momentohq.com")," to raise your account limits. You can check the Drupal dblog and/or the logfile you configure in the settings (instructions below) for rate limiting error messages."),(0,a.kt)("h2",{id:"installing-and-configuring-the-momento-cache-drupal-module"},"Installing and Configuring the Momento Cache Drupal Module"),(0,a.kt)("p",null,"The ",(0,a.kt)("inlineCode",{parentName:"p"},"momento_cache")," module is installed in the usual Drupal way. From your Drupal installation's root directory, use composer to pull in the module: ",(0,a.kt)("inlineCode",{parentName:"p"},"composer require 'momentohq/drupal_cache:0.5.0"),". Then enable the module using the Drupal admin interface or using ",(0,a.kt)("inlineCode",{parentName:"p"},"drush en momento_cache"),"."),(0,a.kt)("p",null,"The next step is to configure the module in your ",(0,a.kt)("inlineCode",{parentName:"p"},"settings.php")," file. If you're planning to use Momento as your global caching backend, add the following: "),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"$settings['cache']['default'] = 'cache.backend.momento_cache';")," "),(0,a.kt)("p",null,"You may also choose to use Momento for specific cache bins instead. For example, to cache the contents of the ",(0,a.kt)("inlineCode",{parentName:"p"},"render")," bin using Momento, you would add:"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"$settings['cache']['bins']['render'] = 'cache.backend.momento_cache'"),"."),(0,a.kt)("p",null,"Next, add the settings necessary to authenticate with Momento and specify your cache name:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-php"},"$settings['momento_cache']['api_token'] = '<YOUR_MOMENTO_TOKEN>';\n$settings['momento_cache']['cache_name'] = '<YOUR_CACHE_NAME>';\n")),(0,a.kt)("p",null,"Replace <YOUR_MOMENTO_TOKEN> with the token you generated in the console. You may also use an environment variable named MOMENTO_API_TOKEN to pass your API token to the Momento cache backend. If both are supplied, the settings file takes precedence. Replace <YOUR_CACHE_NAME> with the name of the underlying Momento cache you created earlier. You may also use an environment variable named MOMENTO_CACHE_NAME to pass this value. If both are supplied, the settings file takes precedence."),(0,a.kt)("p",null,"You may also optionally provide the path to a log file (make sure it's writable by Drupal) for tracking the module's caching operations and how long each operation is taking:"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"$settings['momento_cache']['logfile'] = '<YOUR_LOG_FILE_PATH>';")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"Please be aware")," that this file will grow quickly over time, so if you choose to enable it long-term, you should probably use logrotate or some similar utility to keep it from growing out of control. If you choose not to specify a logfile, errors will still be logged to Drupal's dblog in the ",(0,a.kt)("inlineCode",{parentName:"p"},"momento_cache")," type category."))}m.isMDXComponent=!0}}]);